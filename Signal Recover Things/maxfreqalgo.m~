function [ enf ] = maxfreqalgo( fs,decf,framelen,hoplen,zfac,midf,df,sig )
%MAXFREQALGO - estimates enf from 
filteredSig = filterENF(sig,midf,1,decf);
K = sum(hamming(framelen, 'periodic'))/framelen;

[s, f, t] = stft3(filteredSig, framelen, hoplen, zfac, fs);
[peaks, qifftSig,sfilt,ffilt] = qifft(s,f,(decf-df)*decf,(midf+df)*decf, fs/decf);
tdmfSig = tdmf(qifftSig,50,0.03);

enf = qifftSig; %could also be tdmfSig

end

